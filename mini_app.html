<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TokyoGo - Sushi Delivery</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://api-maps.yandex.ru/2.1/?apikey=eec8e995-4275-4bec-8833-0f91289ae2eb&lang=ru_RU"></script>
    
    <style>
        :root {
            --primary: #FF6B00;
            --bg-color: #FAFAFA;
            --text-dark: #1F1F1F;
            --text-grey: #9CA3AF;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-color); color: var(--text-dark); padding-bottom: 90px; }
        
        /* Utility */
        .hidden { display: none !important; }
        .container { padding: 0 20px; }

        /* ===== –ù–û–í–´–ô –î–ò–ó–ê–ô–ù HEADER (–°–û–°–ò–°–ö–ê) ===== */
        .top-header {
            position: fixed; /* –§–∏–∫—Å–∏—Ä—É–µ–º —Å–≤–µ—Ä—Ö—É */
            top: 15px;       /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
            left: 15px;      /* –û—Ç—Å—Ç—É–ø —Å–ª–µ–≤–∞ */
            right: 15px;     /* –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ */
            
            /* –≠—Ñ—Ñ–µ–∫—Ç —Å—Ç–µ–∫–ª–∞ */
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            
            /* –§–æ—Ä–º–∞ */
            border-radius: 50px; /* –ü–æ–ª–Ω–æ–µ –∑–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ */
            padding: 8px 15px;   /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã */
            
            display: flex;
            justify-content: space-between;
            align-items: center;
            
            /* –¢–µ–Ω–∏ –∏ —Å–ª–æ–∏ */
            box-shadow: 0 10px 25px rgba(0,0,0,0.08); /* –ú—è–≥–∫–∞—è —Ç–µ–Ω—å */
            z-index: 900;
            border: 1px solid rgba(255,255,255,0.6); /* –¢–æ–Ω–∫–∞—è –æ–±–≤–æ–¥–∫–∞ */
        }

        .user-avatar { width: 40px; height: 40px; border-radius: 50%; overflow: hidden; background: #eee; cursor: pointer; border: 2px solid white; }
        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }
        
        .location-block { text-align: center; cursor: pointer; }
        .loc-label { font-size: 10px; color: var(--text-grey); text-transform: uppercase; letter-spacing: 0.5px; }
        .loc-value { font-size: 13px; font-weight: 700; color: var(--text-dark); display: flex; align-items: center; justify-content: center; gap: 4px; }
        
        .notification-btn { width: 38px; height: 38px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); position: relative; color: var(--primary); }
        .notification-dot { position: absolute; top: 10px; right: 10px; width: 6px; height: 6px; background: red; border-radius: 50%; border: 1px solid #fff; }

        /* –û—Ç—Å—Ç—É–ø –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –æ–Ω –Ω–µ –∑–∞–ª–µ–∑–∞–ª –ø–æ–¥ –Ω–æ–≤—ã–π —Ö–µ–¥–µ—Ä */
        .main-title { padding: 10px 20px; font-size: 24px; font-weight: 700; line-height: 1.3; margin-top: 90px; /* –í–ê–ñ–ù–û: –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */ }

        /* SEARCH */
        .search-section { display: flex; gap: 15px; padding: 10px 20px; margin-bottom: 10px; }
        .search-input-box { flex: 1; background: #fff; border-radius: 12px; padding: 12px 15px; display: flex; align-items: center; gap: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02); }
        .search-input-box input { border: none; outline: none; width: 100%; font-family: inherit; font-size: 14px; }
        .filter-btn { width: 50px; height: 50px; background: var(--primary); border-radius: 14px; display: flex; align-items: center; justify-content: center; color: white; flex-shrink: 0; box-shadow: 0 4px 10px rgba(255, 107, 0, 0.3); }

        /* SECTIONS */
        .section-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; }
        .section-title { font-size: 18px; font-weight: 600; }
        .see-all { color: var(--primary); font-size: 13px; font-weight: 500; text-decoration: none; }

        /* CATEGORIES */
        .categories-scroll { display: flex; overflow-x: auto; gap: 12px; padding: 0 20px 20px; scrollbar-width: none; }
        .categories-scroll::-webkit-scrollbar { display: none; }
        .cat-capsule { display: flex; align-items: center; gap: 8px; background: #fff; padding: 6px 16px 6px 6px; border-radius: 30px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); transition: all 0.3s; cursor: pointer; white-space: nowrap; border: 1px solid transparent; }
        .cat-capsule.active { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(255, 107, 0, 0.3); }
        .cat-icon { width: 32px; height: 32px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; }
        .cat-text { font-size: 13px; font-weight: 500; }

        /* PRODUCTS GRID */
        .products-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 0 20px; }
        .product-card { background: #fff; border-radius: 20px; padding: 12px; position: relative; box-shadow: var(--card-shadow); display: flex; flex-direction: column; }
        .product-card:active { transform: scale(0.98); transition: 0.1s; }
        
        .card-img-wrapper { width: 100%; height: 100px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; }
        .card-img-wrapper img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.1)); }
        
        .fav-icon { position: absolute; top: 10px; right: 10px; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; background: #fff; border-radius: 50%; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); cursor: pointer; z-index: 2; }
        .fav-icon svg { width: 18px; height: 18px; stroke: #ff4757; stroke-width: 2; fill: none; transition: fill 0.3s; }
        .fav-icon.fav-active svg { fill: #ff4757; }

        .card-title { font-size: 14px; font-weight: 700; margin-bottom: 4px; color: var(--text-dark); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .card-desc { font-size: 11px; color: var(--text-grey); margin-bottom: 12px; height: 16px; overflow: hidden; }
        .card-bottom { display: flex; justify-content: space-between; align-items: center; margin-top: auto; }
        .price-btn { background: var(--primary); color: white; border: none; border-radius: 8px; padding: 8px 12px; font-size: 12px; font-weight: 600; cursor: pointer; }
        .add-btn-small { background: #F3F4F6; color: var(--text-dark); width: 32px; height: 32px; border-radius: 8px; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 16px; }

        /* PROMO BANNER */
        .promo-banner { margin: 25px 20px; padding: 0; background: none; cursor: pointer; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); }
        .promo-banner img { width: 100%; height: auto; display: block; object-fit: cover; }

        /* BOTTOM NAV */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 10px 30px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.03); z-index: 100; border-radius: 20px 20px 0 0; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: #C0C0C0; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .nav-icon svg { width: 24px; height: 24px; fill: currentColor; }

        /* MODALS (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ) */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: 1000; align-items: flex-end; }
        .modal.active { display: flex; }
        .modal-content { background: white; width: 100%; padding: 20px; border-radius: 25px 25px 0 0; animation: slideUp 0.3s; max-height: 90vh; overflow-y: auto; }
        
        /* AUTH MODAL */
        #authModal { align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        #authModal .modal-content { border-radius: 25px; width: 90%; max-width: 400px; padding: 30px; animation: fadeIn 0.3s; }
        .auth-title { font-size: 22px; font-weight: 700; text-align: center; margin-bottom: 20px; }
        .auth-input { width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 12px; font-family: inherit; font-size: 15px; }
        .auth-btn { width: 100%; background: var(--primary); color: white; padding: 15px; border: none; border-radius: 12px; font-weight: 600; font-size: 16px; cursor: pointer; box-shadow: 0 4px 15px rgba(255,107,0,0.3); }

        /* CART STYLES */
        .cart-header-row { display: flex; align-items: center; justify-content: center; position: relative; margin-bottom: 25px; }
        .cart-back-btn { position: absolute; left: 0; font-size: 24px; cursor: pointer; color: var(--text-dark); }
        .cart-title-text { font-size: 18px; font-weight: 700; }
        .cart-item { background: #fff; border-radius: 15px; padding: 10px; margin-bottom: 15px; box-shadow: 0 2px 15px rgba(0, 0, 0, 0.03); display: flex; align-items: center; gap: 15px; border: 1px solid #f0f0f0; }
        .cart-item-img { width: 60px; height: 60px; object-fit: contain; flex-shrink: 0; }
        .cart-item-info { flex: 1; }
        .cart-item-title { font-size: 14px; font-weight: 600; color: var(--text-dark); margin-bottom: 5px; }
        .cart-item-price { font-size: 14px; font-weight: 600; color: var(--primary); }
        .cart-item-controls { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }
        .qty-control { display: flex; align-items: center; gap: 8px; }
        .qty-btn { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 16px; font-weight: 500; line-height: 1; }
        .qty-btn.minus { border: 1px solid var(--primary); color: var(--primary); background: transparent; }
        .qty-btn.plus { background: var(--primary); color: white; border: none; }
        .trash-btn { color: #ff4757; background: none; border: none; font-size: 16px; cursor: pointer; opacity: 0.7; }
        .cart-summary { margin-top: 30px; padding-top: 20px; border-top: 1px solid #f0f0f0; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px; color: var(--text-dark); font-weight: 500; }
        .summary-row.total { margin-top: 15px; font-size: 18px; font-weight: 700; color: var(--text-dark); padding-top: 15px; border-top: 1px solid #eee; }
        .checkout-btn { width: 100%; background: var(--primary); color: white; padding: 16px; border: none; border-radius: 15px; font-weight: 600; font-size: 16px; margin-top: 20px; box-shadow: 0 5px 15px rgba(255, 107, 0, 0.3); cursor: pointer; }

        /* PROFILE STYLES */
        .profile-header { display: flex; flex-direction: column; align-items: center; padding: 20px 0; }
        .avatar-container { position: relative; width: 110px; height: 110px; margin-bottom: 15px; }
        .avatar-full { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid #fff; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        .edit-badge { position: absolute; bottom: 5px; right: 5px; width: 32px; height: 32px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid #fff; cursor: pointer; }
        .edit-badge svg { width: 16px; height: 16px; fill: none; stroke: white; stroke-width: 2; }
        .profile-name { font-size: 20px; font-weight: 700; color: var(--text-dark); margin-bottom: 5px; }
        .profile-phone { font-size: 14px; color: var(--text-grey); margin-bottom: 20px; }
        .profile-menu { display: flex; flex-direction: column; padding: 0 10px; }
        .menu-row { display: flex; align-items: center; padding: 16px 0; cursor: pointer; background: transparent; border: none; width: 100%; text-align: left; }
        .menu-icon-left { width: 24px; height: 24px; margin-right: 15px; color: var(--primary); }
        .menu-icon-left svg { width: 100%; height: 100%; stroke: currentColor; stroke-width: 1.5; fill: none; }
        .menu-label { flex: 1; font-size: 15px; font-weight: 500; color: #333; }
        .menu-arrow-right { color: var(--primary); }
        
        /* Language Switcher */
        .lang-switcher { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; width: 100%; padding: 0 20px; }
        .lang-btn { flex: 1; padding: 10px; border: 1px solid #eee; background: white; border-radius: 10px; cursor: pointer; font-weight: 600; color: #999; transition: 0.2s; text-align: center; }
        .lang-btn.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 4px 10px rgba(255,107,0,0.2); }

        /* Favourite items */
        .rating-badge { display: flex; align-items: center; gap: 4px; font-size: 12px; color: #333; font-weight: 600; }
        .rating-star { color: #FFC107; font-size: 14px; }
        .fav-card-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .fav-price { color: var(--primary); font-weight: 700; font-size: 14px; }

        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div class="top-header">
        <div class="user-avatar" onclick="openProfile()">
            <img id="headerAvatar" src="https://ui-avatars.com/api/?name=User&background=FF6B00&color=fff" alt="User">
        </div>
        <div class="location-block" onclick="openAddressModal()">
            <div class="loc-label" data-i18n="deliveryTo">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ ‚ñæ</div>
            <div class="loc-value">
                <span id="headerAddress" data-i18n="addressPlaceholder">–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å</span>
            </div>
        </div>
        <div class="notification-btn" onclick="alert(t('noNotifications'))">
            üîî
            <div class="notification-dot"></div>
        </div>
    </div>

    <div class="main-title" data-i18n="mainTitle">
        –ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ<br>–∑–∞–∫–∞–∑–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?
    </div>

    <div class="search-section">
        <div class="search-input-box">
            <span>üîç</span>
            <input type="text" id="searchInput" data-i18n-placeholder="searchPlaceholder" placeholder="–ù–∞–π—Ç–∏ —Å—É—à–∏, —Ä–æ–ª–ª—ã..." oninput="renderProducts()">
        </div>
        <div class="filter-btn" onclick="alert(t('filters'))">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
        </div>
    </div>

    <div class="section-header">
        <div class="section-title" data-i18n="categories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
        <a href="#" class="see-all" data-i18n="seeAll">–í—Å–µ</a>
    </div>
    <div class="categories-scroll" id="categoriesContainer"></div>

    <div class="section-header">
        <div class="section-title" data-i18n="popular">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</div>
        <a href="#" class="see-all" data-i18n="seeAll">–í—Å–µ</a>
    </div>
    <div class="products-grid" id="productsGrid"></div>

    <div class="promo-banner" onclick="document.getElementById('productsGrid').scrollIntoView({behavior: 'smooth'})">
        <img src="img/sushi.png" alt="Promo Banner" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2224/2224268.png'">
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="updateNav(this, 'menu')">
            <div class="nav-icon"><svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" /></svg></div>
        </div>
        <div class="nav-item" onclick="openCart()">
            <div class="nav-icon" style="position:relative;">
                <svg viewBox="0 0 24 24"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" /></svg>
                <span id="cartBadge" style="position:absolute; top:-5px; right:-8px; background:var(--primary); color:white; font-size:10px; width:16px; height:16px; border-radius:50%; display:none; align-items:center; justify-content:center;">0</span>
            </div>
        </div>
        <div class="nav-item" onclick="openFavorites()">
            <div class="nav-icon"><svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" /></svg></div>
        </div>
        <div class="nav-item" onclick="openProfile()">
            <div class="nav-icon"><svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" /></svg></div>
        </div>
    </div>

    <div class="modal" id="authModal" style="z-index: 2000;">
        <div class="modal-content">
            <div class="auth-title" data-i18n="authTitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</div>
            <input type="text" id="regName" class="auth-input" placeholder="–í–∞—à–µ –∏–º—è" data-i18n-placeholder="namePlaceholder">
            <input type="tel" id="regPhone" class="auth-input" placeholder="+998 90 123 45 67" data-i18n-placeholder="phonePlaceholder">
            <button class="auth-btn" onclick="registerUser()" data-i18n="authBtn">–í–æ–π—Ç–∏</button>
        </div>
    </div>

    <div class="modal" id="addressModal">
        <div class="modal-content">
            <h3 style="margin-bottom:15px;" data-i18n="deliveryAddr">üìç –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
            <div id="mapContainer" style="width:100%; height:200px; background:#eee; border-radius:15px; margin-bottom:15px; display:flex; align-items:center; justify-content:center; color:#999;"></div>
            <input type="text" id="cityInput" class="auth-input" data-i18n-placeholder="city" placeholder="–ì–æ—Ä–æ–¥">
            <input type="text" id="streetInput" class="auth-input" data-i18n-placeholder="street" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º">
            <button onclick="saveAddress()" class="auth-btn" data-i18n="save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button onclick="closeModal('addressModal')" style="width:100%; margin-top:10px; background:transparent; color:#999; border:none;" data-i18n="close">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="modal" id="cartModal">
        <div class="modal-content">
            <div id="cartList"></div>
            <div id="cartTotalBlock" class="hidden"></div>
        </div>
    </div>

    <div class="modal" id="favModal">
        <div class="modal-content">
            <div class="cart-header-row">
                <div class="cart-back-btn" onclick="closeModal('favModal')">‚Üê</div>
                <div class="cart-title-text" data-i18n="favourite">Favourite</div>
            </div>
            <div class="products-grid" id="favGrid"></div>
        </div>
    </div>

    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="cart-header-row">
                <div class="cart-back-btn" onclick="closeModal('profileModal')">‚Üê</div>
                <div class="cart-title-text" data-i18n="profile">Profile</div>
            </div>

            <div class="profile-header">
                <div class="avatar-container">
                    <img id="profileAvatar" src="" class="avatar-full" alt="Avatar">
                    <div class="edit-badge" onclick="alert(t('editNotAvailable'))">
                        <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                    </div>
                </div>
                <div class="profile-name" id="profileNameDisplay">User</div>
                <div class="profile-phone" id="profilePhoneDisplay">+998...</div>
            </div>

            <div class="lang-switcher">
                <div class="lang-btn" onclick="setLanguage('ru')" id="btn-ru">RU</div>
                <div class="lang-btn" onclick="setLanguage('uz')" id="btn-uz">UZ</div>
                <div class="lang-btn" onclick="setLanguage('en')" id="btn-en">EN</div>
            </div>

            <div class="profile-menu">
                <button class="menu-row">
                    <div class="menu-icon-left"><svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div>
                    <span class="menu-label" data-i18n="yourProfile">Your profile</span>
                    <div class="menu-arrow-right">‚Ä∫</div>
                </button>
                <button class="menu-row" onclick="openAddressModal()">
                    <div class="menu-icon-left"><svg viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg></div>
                    <span class="menu-label" data-i18n="manageAddress">Manage Address</span>
                    <div class="menu-arrow-right">‚Ä∫</div>
                </button>
                <button class="menu-row">
                    <div class="menu-icon-left"><svg viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg></div>
                    <span class="menu-label" data-i18n="paymentMethods">Payment Methods</span>
                    <div class="menu-arrow-right">‚Ä∫</div>
                </button>
                <button class="menu-row" onclick="logout()">
                    <div class="menu-icon-left" style="color:#ff4757;"><svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg></div>
                    <span class="menu-label" style="color:#ff4757;" data-i18n="logout">Logout</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            ru: {
                mainTitle: "–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ<br>–∑–∞–∫–∞–∑–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?",
                searchPlaceholder: "–ù–∞–π—Ç–∏ —Å—É—à–∏, —Ä–æ–ª–ª—ã...",
                deliveryTo: "–î–æ—Å—Ç–∞–≤–∫–∞ –≤ ‚ñæ",
                addressPlaceholder: "–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å",
                categories: "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
                popular: "–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ",
                seeAll: "–í—Å–µ",
                favourite: "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ",
                profile: "–ü—Ä–æ—Ñ–∏–ª—å",
                cart: "–ö–æ—Ä–∑–∏–Ω–∞",
                emptyCart: "–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üòî",
                myCart: "–ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞",
                subtotal: "–ü–æ–¥—ã—Ç–æ–≥",
                delivery: "–î–æ—Å—Ç–∞–≤–∫–∞",
                total: "–ò–¢–û–ì–û",
                checkout: "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑",
                addToCart: "–í –∫–æ—Ä–∑–∏–Ω—É",
                currency: "—Å—É–º",
                authTitle: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
                namePlaceholder: "–í–∞—à–µ –∏–º—è",
                phonePlaceholder: "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
                authBtn: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",
                yourProfile: "–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å",
                manageAddress: "–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏",
                paymentMethods: "–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã",
                logout: "–í—ã–π—Ç–∏",
                filters: "–§–∏–ª—å—Ç—Ä—ã",
                noNotifications: "–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π",
                editNotAvailable: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ",
                deliveryAddr: "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏",
                city: "–ì–æ—Ä–æ–¥",
                street: "–£–ª–∏—Ü–∞, –¥–æ–º",
                save: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
                close: "–ó–∞–∫—Ä—ã—Ç—å",
                cat_sushi: "–°—É—à–∏", cat_noodles: "–õ–∞–ø—à–∞", cat_rolls: "–†–æ–ª–ª—ã", cat_soups: "–°—É–ø—ã", cat_drinks: "–í–æ–¥–∞"
            },
            uz: {
                mainTitle: "Bugun nima<br>buyurtma qilasiz?",
                searchPlaceholder: "Sushi va rollarni qidirish...",
                deliveryTo: "Yetkazib berish ‚ñæ",
                addressPlaceholder: "Manzilni kiriting",
                categories: "Kategoriyalar",
                popular: "Ommabop",
                seeAll: "Barchasi",
                favourite: "Sevimlilar",
                profile: "Profil",
                cart: "Savatcha",
                emptyCart: "Savatcha bo'sh üòî",
                myCart: "Mening savatcham",
                subtotal: "Jami",
                delivery: "Yetkazib berish",
                total: "JAMI",
                checkout: "Buyurtma berish",
                addToCart: "Savatga",
                currency: "so'm",
                authTitle: "Xush kelibsiz!",
                namePlaceholder: "Ismingiz",
                phonePlaceholder: "Telefon raqamingiz",
                authBtn: "Davom etish",
                yourProfile: "Mening profilim",
                manageAddress: "Manzillar",
                paymentMethods: "To'lov turlari",
                logout: "Chiqish",
                filters: "Filtrlar",
                noNotifications: "Bildirishnomalar yo'q",
                editNotAvailable: "Tahrirlash hozircha mavjud emas",
                deliveryAddr: "Yetkazib berish manzili",
                city: "Shahar",
                street: "Ko'cha, uy",
                save: "Saqlash",
                close: "Yopish",
                cat_sushi: "Sushi", cat_noodles: "Lag'mon", cat_rolls: "Roll", cat_soups: "Sho'rva", cat_drinks: "Ichimlik"
            },
            en: {
                mainTitle: "What would you<br>like to order?",
                searchPlaceholder: "Search sushi, rolls...",
                deliveryTo: "Deliver to ‚ñæ",
                addressPlaceholder: "Set address",
                categories: "Categories",
                popular: "Popular",
                seeAll: "See all",
                favourite: "Favourite",
                profile: "Profile",
                cart: "Cart",
                emptyCart: "Cart is empty üòî",
                myCart: "My Cart",
                subtotal: "Subtotal",
                delivery: "Delivery",
                total: "TOTAL",
                checkout: "Checkout",
                addToCart: "Add to cart",
                currency: "UZS",
                authTitle: "Welcome!",
                namePlaceholder: "Your Name",
                phonePlaceholder: "Phone Number",
                authBtn: "Continue",
                yourProfile: "My Profile",
                manageAddress: "Manage Address",
                paymentMethods: "Payment Methods",
                logout: "Logout",
                filters: "Filters",
                noNotifications: "No notifications",
                editNotAvailable: "Edit not available yet",
                deliveryAddr: "Delivery Address",
                city: "City",
                street: "Street",
                save: "Save",
                close: "Close",
                cat_sushi: "Sushi", cat_noodles: "Noodles", cat_rolls: "Rolls", cat_soups: "Soups", cat_drinks: "Drinks"
            }
        };

        let currentLang = localStorage.getItem('tokyo_lang') || 'ru';

        function t(key) {
            return translations[currentLang][key] || key;
        }

        function updateTexts() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.innerHTML = t(key);
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                el.placeholder = t(key);
            });
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${currentLang}`).classList.add('active');
            renderCategories();
            renderProducts();
            if(document.getElementById('cartModal').classList.contains('active')) renderCartItems();
            if(document.getElementById('favModal').classList.contains('active')) renderFavorites();
        }

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('tokyo_lang', lang);
            updateTexts();
        }

        const categories = [
            { id: 'sushi', key: 'cat_sushi', icon: 'üç£' },
            { id: 'noodles', key: 'cat_noodles', icon: 'üçú' },
            { id: 'rolls', key: 'cat_rolls', icon: 'üç±' },
            { id: 'soups', key: 'cat_soups', icon: 'üç≤' },
            { id: 'drinks', key: 'cat_drinks', icon: 'ü•§' },
        ];

        const products = [
            { 
                id: 1, 
                name_ru: "–§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è", name_uz: "Filadelfiya", name_en: "Philadelphia",
                desc_ru: "4 —à—Ç ¬∑ –õ–æ—Å–æ—Å—å, —Å—ã—Ä", desc_uz: "4 dona ¬∑ Losos, sir", desc_en: "4 pcs ¬∑ Salmon, cheese",
                price: 35000, category: "rolls", img: "https://cdn-icons-png.flaticon.com/512/3183/3183460.png" 
            },
            { 
                id: 2, 
                name_ru: "–ú–∞–∫–∏ —Å –æ–≥—É—Ä—Ü–æ–º", name_uz: "Bodringli Maki", name_en: "Cucumber Maki",
                desc_ru: "6 —à—Ç ¬∑ –†–∏—Å, –æ–≥—É—Ä–µ—Ü", desc_uz: "6 dona ¬∑ Guruch, bodring", desc_en: "6 pcs ¬∑ Rice, cucumber",
                price: 15000, category: "sushi", img: "https://cdn-icons-png.flaticon.com/512/3183/3183451.png" 
            },
            { 
                id: 3, 
                name_ru: "–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è", name_uz: "Kaliforniya", name_en: "California",
                desc_ru: "4 —à—Ç ¬∑ –ö—Ä–∞–±, –∏–∫—Ä–∞", desc_uz: "4 dona ¬∑ Qisqichbaqa, ikra", desc_en: "4 pcs ¬∑ Crab, caviar",
                price: 32000, category: "rolls", img: "https://cdn-icons-png.flaticon.com/512/3183/3183471.png" 
            },
            { 
                id: 4, 
                name_ru: "–†–∞–º–µ–Ω", name_uz: "Ramen", name_en: "Ramen",
                desc_ru: "400–≥ ¬∑ –ö—É—Ä–∏—Ü–∞", desc_uz: "400g ¬∑ Tovuq", desc_en: "400g ¬∑ Chicken",
                price: 45000, category: "noodles", img: "https://cdn-icons-png.flaticon.com/512/3014/3014520.png" 
            },
             { 
                id: 5, 
                name_ru: "–°—É—à–∏ –°–µ—Ç", name_uz: "Sushi Set", name_en: "Sushi Set",
                desc_ru: "12 —à—Ç ¬∑ –ê—Å—Å–æ—Ä—Ç–∏", desc_uz: "12 dona ¬∑ Assorti", desc_en: "12 pcs ¬∑ Assorted",
                price: 120000, category: "rolls", img: "https://cdn-icons-png.flaticon.com/512/3480/3480838.png" 
            },
            { 
                id: 6, 
                name_ru: "–¢–æ–º –Ø–º", name_uz: "Tom Yum", name_en: "Tom Yum",
                desc_ru: "–û—Å—Ç—Ä—ã–π —Å—É–ø", desc_uz: "Achchiq sho'rva", desc_en: "Spicy soup",
                price: 40000, category: "soups", img: "https://cdn-icons-png.flaticon.com/512/2038/2038933.png" 
            },
        ];

        let cart = [];
        let favorites = [1, 2];
        let currentCat = 'sushi';
        let currentUser = null;

        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            updateTexts();
            renderCategories();
            renderProducts();
            loadAddress();
            
            // –í–û–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î –ó–ê–ö–†–´–¢–ò–Ø –ú–û–î–ê–õ–û–ö
            // –ú—ã –≤–µ—à–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ window, —á—Ç–æ–±—ã –ª–æ–≤–∏—Ç—å –≤—Å–µ –∫–ª–∏–∫–∏
            window.onclick = function(event) {
                // –ï—Å–ª–∏ –∫–ª–∏–∫ –±—ã–ª –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É —Å –∫–ª–∞—Å—Å–æ–º 'modal'
                if (event.target.classList.contains('modal')) {
                    // –ò —ç—Ç–æ –ù–ï –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–µ–≥–æ –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –∫–ª–∏–∫–æ–º)
                    if (event.target.id !== 'authModal') {
                        event.target.classList.remove('active');
                    }
                }
            };
        });

        function checkAuth() {
            const userStr = localStorage.getItem('tokyo_user');
            if(userStr) {
                currentUser = JSON.parse(userStr);
                updateProfileUI();
            } else {
                document.getElementById('authModal').classList.add('active');
            }
        }

        function registerUser() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            if(!name || !phone) return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è');
            currentUser = { name, phone };
            localStorage.setItem('tokyo_user', JSON.stringify(currentUser));
            document.getElementById('authModal').classList.remove('active');
            updateProfileUI();
        }

        function updateProfileUI() {
            if(currentUser) {
                document.getElementById('profileNameDisplay').textContent = currentUser.name;
                document.getElementById('profilePhoneDisplay').textContent = currentUser.phone;
                const avaUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=FF6B00&color=fff&size=256`;
                document.getElementById('profileAvatar').src = avaUrl;
                document.getElementById('headerAvatar').src = avaUrl;
            }
        }

        function logout() {
            if(confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
                localStorage.removeItem('tokyo_user');
                location.reload();
            }
        }

        function formatPrice(price) {
            return price.toLocaleString('ru-RU') + ' ' + t('currency');
        }

        function renderCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = categories.map(cat => `
                <div class="cat-capsule ${cat.id === currentCat ? 'active' : ''}" onclick="selectCategory('${cat.id}')">
                    <div class="cat-icon" style="color: ${cat.id === currentCat ? 'var(--primary)' : '#333'}">${cat.icon}</div>
                    <span class="cat-text">${t(cat.key)}</span>
                </div>
            `).join('');
        }

        function selectCategory(id) {
            currentCat = id;
            renderCategories();
            renderProducts();
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            const filtered = products.filter(p => 
                (p.category === currentCat || currentCat === 'all') && 
                (p[`name_${currentLang}`].toLowerCase().includes(searchVal))
            );

            grid.innerHTML = filtered.map(p => {
                const isFav = favorites.includes(p.id);
                const name = p[`name_${currentLang}`];
                const desc = p[`desc_${currentLang}`];
                return `
                <div class="product-card">
                    <div class="fav-icon ${isFav ? 'fav-active' : ''}" onclick="toggleFavorite(${p.id})">
                        <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                    </div>
                    <div class="card-img-wrapper"><img src="${p.img}" alt="${name}"></div>
                    <div class="card-title">${name}</div>
                    <div class="card-desc">${desc}</div>
                    <div class="card-bottom">
                        <button class="price-btn" onclick="addToCart(${p.id})">${formatPrice(p.price)}</button>
                        <button class="add-btn-small" onclick="addToCart(${p.id})">üõí</button>
                    </div>
                </div>
            `}).join('');
        }

        function addToCart(id) {
            const prod = products.find(p => p.id === id);
            const exist = cart.find(c => c.id === id);
            if(exist) exist.qty++; else cart.push({...prod, qty: 1});
            updateCart();
            const badge = document.getElementById('cartBadge');
            badge.style.transform = 'scale(1.5)';
            setTimeout(() => badge.style.transform = 'scale(1)', 200);
        }

        function updateCart() {
            const totalQty = cart.reduce((sum, i) => sum + i.qty, 0);
            const badge = document.getElementById('cartBadge');
            badge.textContent = totalQty;
            badge.style.display = totalQty > 0 ? 'flex' : 'none';
        }

        function openCart() {
            document.getElementById('cartModal').classList.add('active');
            renderCartItems();
        }

        function renderCartItems() {
            const list = document.getElementById('cartList');
            list.innerHTML = `
                <div class="cart-header-row">
                    <div class="cart-back-btn" onclick="closeModal('cartModal')">‚Üê</div>
                    <div class="cart-title-text">${t('myCart')}</div>
                </div>
            `;

            if(cart.length === 0) {
                list.innerHTML += `<div style="text-align:center; padding:50px 0; color:#999">${t('emptyCart')}</div>`;
                return;
            }

            let html = '<div class="cart-items-container">';
            let subtotal = 0;

            cart.forEach(item => {
                subtotal += item.price * item.qty;
                const name = item[`name_${currentLang}`];
                html += `
                <div class="cart-item">
                    <img src="${item.img}" class="cart-item-img">
                    <div class="cart-item-info">
                        <div class="cart-item-title">${name}</div>
                        <div class="cart-item-price">${formatPrice(item.price)}</div>
                    </div>
                    <div class="cart-item-controls">
                        <div class="qty-control">
                            <div class="qty-btn minus" onclick="changeQty(${item.id}, -1)">‚àí</div>
                            <span style="font-weight:600;">${item.qty}</span>
                            <div class="qty-btn plus" onclick="changeQty(${item.id}, 1)">+</div>
                        </div>
                        <button class="trash-btn" onclick="removeFromCart(${item.id})">
                             <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                        </button>
                    </div>
                </div>`;
            });
            
            const deliveryCost = 15000; 
            const total = subtotal + deliveryCost;

            html += `</div>
            <div class="cart-summary">
                <div class="summary-row"><span>${t('subtotal')}</span><span>${formatPrice(subtotal)}</span></div>
                <div class="summary-row"><span>${t('delivery')}</span><span>${formatPrice(deliveryCost)}</span></div>
                <div class="summary-row total"><span>${t('total')} :</span><span>${formatPrice(total)}</span></div>
                <button class="checkout-btn" onclick="alert('Order sent!')">${t('checkout')}</button>
            </div>`;
            
            list.innerHTML += html;
        }

        function changeQty(id, change) {
            const item = cart.find(i => i.id === id);
            if (!item) return;
            item.qty += change;
            if (item.qty <= 0) removeFromCart(id);
            else { updateCart(); renderCartItems(); }
        }

        function removeFromCart(id) {
            cart = cart.filter(i => i.id !== id);
            updateCart();
            renderCartItems();
        }

        function openFavorites() {
            document.getElementById('favModal').classList.add('active');
            renderFavorites();
        }

        function toggleFavorite(id) {
            if (favorites.includes(id)) favorites = favorites.filter(favId => favId !== id);
            else favorites.push(id);
            renderProducts();
            renderFavorites();
        }

        function renderFavorites() {
            const grid = document.getElementById('favGrid');
            const favProducts = products.filter(p => favorites.includes(p.id));
            if(favProducts.length === 0) {
                grid.innerHTML = `<div style="text-align:center; width:200%; padding-top:50px; color:#999;">üíî</div>`;
                return;
            }
            grid.innerHTML = favProducts.map(p => `
                <div class="product-card">
                    <div class="fav-icon fav-active" onclick="toggleFavorite(${p.id})">
                        <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                    </div>
                    <div class="card-img-wrapper"><img src="${p.img}"></div>
                    <div class="fav-card-row">
                        <div class="card-title" style="margin:0; font-size:13px;">${p[`name_${currentLang}`]}</div>
                        <div class="rating-badge"><span class="rating-star">‚òÖ</span> 4.8</div>
                    </div>
                    <div class="fav-price">${formatPrice(p.price)}</div>
                    <button class="price-btn" style="width:100%; margin-top:5px;" onclick="addToCart(${p.id})">${t('addToCart')}</button>
                </div>
            `).join('');
        }

        function openAddressModal() {
            document.getElementById('addressModal').classList.add('active');
            setTimeout(() => {
                if(window.ymaps && document.getElementById('mapContainer').innerHTML === "") {
                    ymaps.ready(() => {
                        new ymaps.Map('mapContainer', { center: [41.2995, 69.2401], zoom: 12 });
                    });
                }
            }, 100);
        }
        function saveAddress() {
            const city = document.getElementById('cityInput').value || 'Tashkent';
            const street = document.getElementById('streetInput').value || 'Center';
            localStorage.setItem('userAddress', `${city}, ${street}`);
            document.getElementById('headerAddress').textContent = street;
            document.getElementById('addressModal').classList.remove('active');
        }
        function loadAddress() {
            const addr = localStorage.getItem('userAddress');
            if(addr) document.getElementById('headerAddress').textContent = addr.split(',')[1];
        }
        function updateNav(el, type) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }
        function openProfile() {
            document.getElementById('profileModal').classList.add('active');
        }
        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }
    </script>
</body>
</html>